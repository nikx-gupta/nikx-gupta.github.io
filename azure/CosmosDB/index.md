---
title: Azure CosmosDB
---

### Important
- Once container is created `Partition key cannot be changed`. To change partition key `Create new container` and migrate data.
- `Unique Key` concept is only applicable to Cosmosdb with `SQL Api`

### Topics
- ### [Insert/Update Rules](InsertUpdateRules)
- ### Security
    - ### [Resource Token](ResourceToken)
    
### SDK
- ### .NET Core
> Package Microsoft.Azure.Cosmos

### CLI
- ### CosmosDb
```shell
    Group
        az cosmosdb : Manage Azure Cosmos DB database accounts.
    
    Subgroups:
        cassandra                   : Manage Cassandra resources of Azure Cosmos DB account.
        gremlin                     : Manage Gremlin resources of Azure Cosmos DB account.
        keys                        : Manage Azure Cosmos DB keys.
        mongodb                     : Manage MongoDB resources of Azure Cosmos DB account.
        network-rule                : Manage Azure Cosmos DB network rules.
        private-endpoint-connection : Manage Azure Cosmos DB private endpoint connections.
        private-link-resource       : Manage Azure Cosmos DB private link resources.
        sql                         : Manage SQL resources of Azure Cosmos DB account.
        table                       : Manage Table resources of Azure Cosmos DB account.
    
    Commands:
        check-name-exists           : Checks if an Azure Cosmos DB account name exists.
        create                      : Creates a new Azure Cosmos DB database account.
        delete                      : Deletes an Azure Cosmos DB database account.
        failover-priority-change    : Changes the failover priority for the Azure Cosmos DB database
                                      account.
        list                        : List Azure Cosmos DB database accounts.
        show                        : Get the details of an Azure Cosmos DB database account.
        update                      : Update an Azure Cosmos DB database account.
    
    Examples
        Get the details of an Azure Cosmos DB database account. (autogenerated)
          az cosmosdb show --name MyCosmosDBDatabaseAccount --resource-group MyResourceGroup
        
        Update an Azure Cosmos DB database account. (autogenerated)
          az cosmosdb update --ip-range-filter {ip-range-filter} --name MyCosmosDBDatabaseAccount --resource-group MyResourceGroup
        
        Deletes an Azure Cosmos DB database account. (autogenerated)
          az cosmosdb delete --name MyCosmosDBDatabaseAccount --resource-group MyResourceGroup
```

- ### Create Account
```shell
    Command
        az cosmosdb create : Creates a new Azure Cosmos DB database account.
    
    Arguments
        --name -n                      [Required] : Name of the Cosmos DB database account.
        --resource-group -g            [Required] : Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
        --capabilities                            : Set custom capabilities on the Cosmos DB database account.
        --default-consistency-level               : Default consistency level of the Cosmos DB database account.  
                                                    Allowed values: BoundedStaleness, ConsistentPrefix, Eventual, Session, Strong.
        --disable-key-based-metadata-write-access : Disable write operations on metadata resources (databases, containers, throughput) via account keys.
                                                    Allowed values: false, true.
        --enable-analytical-storage     [Preview] : Flag to enable log storage on the account.
                                                    Allowed values: false, true.
            Argument '--enable-analytical-storage' is in preview. It may be changed/removed in a future release.
        --enable-automatic-failover               : Enables automatic failover of the write region in the rare event that the region is unavailable due to
                                                    an outage. Automatic failover will result in a new write region for the account and is chosen based on
                                                    the failover priorities configured for the account.
                                                    Allowed values: false, true.
        --enable-free-tier              [Preview] : If enabled the account is free-tier.
                                                    Allowed values: false, true.
            Argument '--enable-free-tier' is in preview. It may be changed/removed in a future release.
        --enable-multiple-write-locations         : Enable Multiple Write Locations.  
                                                    Allowed values: false, true.
        --enable-public-network -e                : Enable or disable public network access to server.
                                                    Allowed values: false, true.
        --enable-virtual-network                  : Enables virtual network on the Cosmos DB database account.  Allowed values: false, true.
        --ip-range-filter                         : Firewall support. Specifies the set of IP addresses or IP address ranges in CIDR form to be included as
                                                    the allowed list of client IPs for a given database account. IP addresses/ranges must be comma-separated
                                                    and must not contain any spaces.
        --key-uri                       [Preview] : The URI of the key vault.
            Argument '--key-uri' is in preview. It may be changed/removed in a future release.
        --kind                                    : The type of Cosmos DB database account to create.
                                                    Allowed values: GlobalDocumentDB, MongoDB, Parse.
                                                    Default: GlobalDocumentDB.
        --locations                               : Add a location to the Cosmos DB database account.
            Usage:          --locations KEY=VALUE [KEY=VALUE ...]
            Required Keys:  regionName, failoverPriority
            Optional Key:   isZoneRedundant
            Default:        single region account in the location of the specified resource group.
            Failover priority values are 0 for write regions and greater than 0 for read regions. A
            failover priority value must be unique and less than the total number of regions.
            Multiple locations can be specified by using more than one `--locations` argument.
        --max-interval                            : When used with Bounded Staleness consistency, this
                                                    value represents the time amount of staleness (in
                                                    seconds) tolerated. Accepted range for this value is
                                                    1 - 100.  Default: 5.
        --max-staleness-prefix                    : When used with Bounded Staleness consistency, this
                                                    value represents the number of stale requests
                                                    tolerated. Accepted range for this value is 1 -
                                                    2,147,483,647.  Default: 100.
        --server-version                [Preview] : Valid only for MongoDB accounts.  Allowed
                                                    values: 3.2, 3.6.
            Argument '--server-version' is in preview. It may be changed/removed in a future
            release.
        --tags                                    : Space-separated tags: key[=value] [key[=value] ...].
                                                    Use "" to clear existing tags.
        --virtual-network-rules                   : ACL's for virtual network.
```

- ### Create Container (SQL)
```shell
    Command
        az cosmosdb sql container create : Create an SQL container under an Azure Cosmos DB SQL database.
    
    Arguments
        --account-name -a       [Required] : Cosmosdb account name.
        --database-name -d      [Required] : Database name.
        --name -n               [Required] : Container name.
        --partition-key-path -p [Required] : Partition Key Path, e.g., '/address/zipcode'.
        --resource-group -g     [Required] : Name of resource group. You can configure the default group using `az configure --defaults group=<name>`.
        --analytical-storage-ttl -t        : Analytical TTL, when analytical storage is enabled.
        --conflict-resolution-policy -c    : Conflict Resolution Policy, you can enter it as a string or as a file, e.g., --conflict-resolution-policy @policy-
                                             file.json or --conflict-resolution-policy "{\"mode\":
                                             \"lastWriterWins\", \"conflictResolutionPath\":
                                             \"/path\"}".
        --idx                              : Indexing Policy, you can enter it as a string or as a file,
                                             e.g., --idx @policy-file.json or --idx "{\"indexingMode\":
                                             \"consistent\", \"automatic\": true, \"includedPaths\":
                                             [{\"path\": \"/*\"}], \"excludedPaths\": [{ \"path\":
                                             \"/headquarters/employees/?\"}, { \"path\":
                                             \"/\\"_etag\\"/?\"}]}".  Default: {
          "indexingMode": "consistent",
          "automatic": true,
          "includedPaths": [
            {
              "path": "/*"
            }
          ],
          "excludedPaths": [
            {
              "path": "/\"_etag\"/?"
            }
          ]
        }.
        --max-throughput                   : The maximum throughput resource can scale to (RU/s).
                                             Provided when the resource is autoscale enabled. The
                                             minimum value can be 4000 (RU/s).
        --partition-key-version            : The version of partition key.
        --throughput                       : The throughput of SQL container (RU/s). Default value is
                                             400. Omit this parameter if the database has shared
                                             throughput unless the container should have dedicated
                                             throughput.
        --ttl                              : Default TTL. If the value is missing or set to "-1", items
                                             don’t expire. If the value is set to "n", items will expire
                                             "n" seconds after last modified time.
        --unique-key-policy -u             : Unique Key Policy, you can enter it as a string or as a
                                             file, e.g., --unique-key-policy @policy-file.json or
                                             --unique-key-policy "{\"uniqueKeys\": [{\"paths\":
                                             [\"/path/to/key1\"]}, {\"paths\": [\"/path/to/key2\"]}]}".
```
